# 搜索功能使用说明

## 功能概述
新增的"搜索"功能位于前端界面的主菜单中，提供了一个简洁的搜索框界面，用户可以输入任何内容，AI会自动生成符合表格格式的JSON数据，并支持自动提取纯JSON和本地文件保存。

## 🆕 新增功能特点

### 🔍 智能JSON提取
- **自动识别**：智能识别AI返回内容中的```json代码块
- **格式提取**：自动提取方括号[]内的纯JSON数据
- **格式验证**：验证JSON格式的有效性
- **错误处理**：如果格式无效，显示原始内容供手动修正

### 💾 本地文件管理
- **自动下载**：一键下载生成的JSON文件到本地
- **智能命名**：按`search_{搜索内容}_{时间戳}.json`格式命名
- **专用目录**：创建了`搜索生成的JSON文件`专用存放目录
- **复制功能**：支持一键复制JSON数据到剪贴板

## 功能特点

### 🔍 智能搜索
- **输入内容**：用户在搜索框中输入任何描述性内容
- **AI处理**：系统自动调用DeepSeek Chat API进行智能处理
- **JSON生成**：AI生成包含"序号"、"文本1"、"文本2"、"文本3"字段的JSON数据

### 📋 数据格式
生成的JSON数据格式固定为：
```json
[
  {
    "序号": "1",
    "文本1": "示例内容1",
    "文本2": "示例内容2", 
    "文本3": "示例内容3"
  },
  {
    "序号": "2",
    "文本1": "示例内容1-2",
    "文本2": "示例内容2-2",
    "文本3": "示例内容3-2"
  }
]
```

## 使用步骤

### 1. 访问搜索功能
- 打开前端应用 (http://localhost:3000)
- 在左侧菜单中点击"搜索"选项

### 2. 输入搜索内容
在搜索框中输入描述性内容，例如：
- "手机产品"
- "员工信息"
- "城市数据"
- "任务列表"
- "电子产品"

### 3. 获取结果
- 点击"搜索生成"按钮
- 等待AI处理（通常几秒钟）
- 系统自动提取纯JSON数据

### 4. 保存和使用数据
#### 方式1：自动下载
- 点击"下载JSON文件"按钮
- 文件自动下载到浏览器默认目录
- 建议移动到`搜索生成的JSON文件`目录统一管理

#### 方式2：复制使用
- 点击"复制JSON"按钮
- 数据复制到剪贴板
- 可直接粘贴使用或保存为文件

#### 方式3：直接导入
- 下载JSON文件后
- 使用"JSON文件导入"功能
- 直接导入到飞书表格

## 📁 文件管理

### 专用存放目录
```
项目根目录/搜索生成的JSON文件/
├── README.md (使用说明)
├── 示例_手机产品_2024-06-10T12-00-00.json
├── 示例_员工信息_2024-06-10T12-05-00.json
└── (用户生成的JSON文件...)
```

### 文件命名规则
- 格式：`search_{搜索内容}_{时间戳}.json`
- 示例：`search_手机产品_2024-06-10T12-30-45.json`
- 自动过滤特殊字符，确保文件名有效

## 技术实现

### JSON提取算法
```javascript
// 1. 优先提取```json代码块
const jsonMatch = aiResponse.match(/```json\s*([\s\S]*?)\s*```/);

// 2. 备选方案：提取方括号内容
const bracketMatch = aiResponse.match(/\[[\s\S]*\]/);

// 3. 验证JSON格式
const parsedData = JSON.parse(extractedJson);
```

### 文件下载实现
```javascript
// 创建Blob对象
const blob = new Blob([JSON.stringify(parsedData, null, 2)], { 
  type: 'application/json' 
});

// 创建下载链接
const url = URL.createObjectURL(blob);
const link = document.createElement('a');
link.href = url;
link.download = fileName;
link.click();
```

### API调用
- **模型**：deepseek-chat
- **最大令牌**：2000
- **温度**：0.7
- **超时**：30秒

### 界面特点
- **简洁设计**：只有一个搜索框，操作简单
- **实时反馈**：显示加载状态和处理进度
- **智能结果**：自动提取和验证JSON格式
- **多种操作**：下载、复制、预览多种方式

## 使用场景

### 📱 产品数据
输入："手机产品"
生成包含手机品牌、型号、特性等信息的JSON数据

### 👥 人员信息
输入："员工信息"
生成包含姓名、部门、职位等信息的JSON数据

### 🏙️ 地理数据
输入："中国城市"
生成包含城市名称、省份、特色等信息的JSON数据

### 📋 任务管理
输入："项目任务"
生成包含任务名称、优先级、状态等信息的JSON数据

## 注意事项

1. **网络连接**：需要稳定的网络连接访问AI API
2. **内容描述**：输入内容越具体，生成的数据越准确
3. **数据格式**：生成的数据固定为4个字段格式
4. **文件管理**：建议定期整理`搜索生成的JSON文件`目录
5. **格式验证**：系统会自动验证JSON格式，无效时提供原始内容

## 错误处理

- **网络错误**：显示"搜索失败，请检查网络连接"
- **空输入**：提示"请输入搜索内容"
- **JSON格式错误**：显示原始内容，提供手动修正提示
- **API错误**：自动重试或显示错误信息

## 更新日志

- **v2.0**：新增JSON自动提取和文件下载功能
- **v1.5**：创建专用文件存放目录和管理系统
- **v1.0**：基础搜索功能，支持AI生成JSON数据
- **界面优化**：添加下载按钮和复制功能
- **错误处理**：完善的JSON格式验证和异常处理机制 