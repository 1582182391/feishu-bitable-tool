# ğŸ”§ æœç´¢+å†™å…¥åŠŸèƒ½é—®é¢˜ä¿®å¤

## ğŸ› é—®é¢˜æè¿°

### é”™è¯¯ä¿¡æ¯
```
App.tsx:3261 æœç´¢+å†™å…¥å¤±è´¥: Error: æœªèƒ½è·å–App Token
    at handleSearchWrite (App.tsx:3123:1)
```

### æ ¹æœ¬åŸå› 
1. **åç«¯æœåŠ¡æœªå¯åŠ¨**ï¼šåˆå§‹é—®é¢˜æ˜¯åç«¯æœåŠ¡æ²¡æœ‰è¿è¡Œ
2. **æ•°æ®ç»“æ„è§£æé”™è¯¯**ï¼šå‰ç«¯ä»£ç å¯¹é£ä¹¦APIè¿”å›çš„æ•°æ®ç»“æ„è§£æä¸æ­£ç¡®

## ğŸ” é—®é¢˜åˆ†æ

### 1. åç«¯æœåŠ¡é—®é¢˜
- **ç°è±¡**ï¼š`ERR_CONNECTION_REFUSED` é”™è¯¯
- **åŸå› **ï¼š3001ç«¯å£æ²¡æœ‰æœåŠ¡ç›‘å¬
- **è§£å†³**ï¼šå¯åŠ¨åç«¯æœåŠ¡

### 2. æ•°æ®ç»“æ„è§£æé—®é¢˜
- **ç°è±¡**ï¼š`æœªèƒ½è·å–App Token` é”™è¯¯
- **åŸå› **ï¼šé£ä¹¦APIè¿”å›çš„æ•°æ®ç»“æ„ä¸å‰ç«¯æœŸæœ›ä¸ä¸€è‡´

#### å®é™…APIå“åº”ç»“æ„
```json
{
  "success": true,
  "data": {
    "app": {
      "app_token": "SCnpbUCc4aXVPnsG4iIcn4hwn6c",
      "default_table_id": "tblqByJxZf2HEywU",
      "folder_token": "",
      "name": "æµ‹è¯•åº”ç”¨",
      "url": "https://test-dadn3h32rk6t.feishu.cn/base/..."
    }
  }
}
```

#### å‰ç«¯åŸå§‹è§£æé€»è¾‘
```javascript
// é”™è¯¯çš„è§£ææ–¹å¼
const newAppToken = appData.app_token || appData.appToken || appData.token;
```

#### ä¿®å¤åçš„è§£æé€»è¾‘
```javascript
// æ­£ç¡®çš„è§£ææ–¹å¼
const newAppToken = appData.app?.app_token || appData.app_token || appData.appToken || appData.token;
```

## âœ… ä¿®å¤æ–¹æ¡ˆ

### 1. å¯åŠ¨åç«¯æœåŠ¡
```bash
cd /Users/keep/Desktop/feishu-latest/backend
npm start
```

**éªŒè¯ç»“æœ**ï¼š
- âœ… åç«¯æœåŠ¡æˆåŠŸå¯åŠ¨åœ¨3001ç«¯å£
- âœ… APIæ¥å£å“åº”æ­£å¸¸
- âœ… è¿›ç¨‹ID: 33878

### 2. ä¿®å¤æ•°æ®ç»“æ„è§£æ

#### App Tokenæå–ä¿®å¤
```javascript
// ä¿®å¤å‰
const newAppToken = appData.app_token || appData.appToken || appData.token;

// ä¿®å¤å
const newAppToken = appData.app?.app_token || appData.app_token || appData.appToken || appData.token;
```

#### Table IDæå–ä¿®å¤
```javascript
// ä¿®å¤å‰
const newTableId = tableData.table_id || tableData.tableId || tableData.id;

// ä¿®å¤å
const newTableId = tableData.table_id || tableData.tableId || tableData.id || tableData.table?.table_id;
```

### 3. éªŒè¯ä¿®å¤æ•ˆæœ

#### APIæµ‹è¯•
```bash
curl -X POST http://localhost:3001/api/feishu/app \
  -H "Content-Type: application/json" \
  -d '{"name": "æµ‹è¯•åº”ç”¨"}'
```

**è¿”å›ç»“æœ**ï¼š
```json
{
  "success": true,
  "data": {
    "app": {
      "app_token": "SCnpbUCc4aXVPnsG4iIcn4hwn6c",
      "default_table_id": "tblqByJxZf2HEywU",
      "name": "æµ‹è¯•åº”ç”¨",
      "url": "https://test-dadn3h32rk6t.feishu.cn/base/..."
    }
  }
}
```

#### ç¼–è¯‘æµ‹è¯•
```bash
npm run build
```

**ç»“æœ**ï¼šâœ… ç¼–è¯‘æˆåŠŸï¼Œæ— é”™è¯¯

## ğŸ¯ ä¿®å¤åçš„å®Œæ•´æµç¨‹

### é¢„æœŸæ‰§è¡Œæ­¥éª¤
1. **ğŸ” æ­¥éª¤1**: AIç”Ÿæˆæ•°æ® âœ…
2. **ğŸ—ï¸ æ­¥éª¤2**: åˆ›å»ºå¤šç»´è¡¨æ ¼åº”ç”¨ âœ… (ä¿®å¤App Tokenæå–)
3. **ğŸ“‹ æ­¥éª¤3**: åˆ›å»ºæ•°æ®è¡¨æ ¼ âœ… (ä¿®å¤Table IDæå–)
4. **ğŸ“ æ­¥éª¤4**: æ‰¹é‡å¯¼å…¥æ•°æ® âœ…
5. **ğŸ”— æ­¥éª¤5**: ç”Ÿæˆè®¿é—®é“¾æ¥ âœ…

### æ•°æ®æµå‘
```
ç”¨æˆ·è¾“å…¥ â†’ AIç”ŸæˆJSON â†’ åˆ›å»ºåº”ç”¨(è·å–app_token) â†’ åˆ›å»ºè¡¨æ ¼(è·å–table_id) â†’ å¯¼å…¥æ•°æ® â†’ ç”Ÿæˆé“¾æ¥
```

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### é£ä¹¦APIæ•°æ®ç»“æ„
- **åº”ç”¨åˆ›å»º**ï¼š`response.data.data.app.app_token`
- **è¡¨æ ¼åˆ›å»º**ï¼š`response.data.data.table_id`
- **è®°å½•åˆ›å»º**ï¼šæ ‡å‡†å“åº”æ ¼å¼

### é”™è¯¯å¤„ç†æ”¹è¿›
- å¢åŠ äº†å¯¹åµŒå¥—å¯¹è±¡çš„å®‰å…¨è®¿é—®ï¼ˆä½¿ç”¨`?.`æ“ä½œç¬¦ï¼‰
- ä¿æŒäº†å‘åå…¼å®¹æ€§ï¼ˆå¤šç§å­—æ®µåå°è¯•ï¼‰
- è¯¦ç»†çš„é”™è¯¯æ—¥å¿—è®°å½•

### ä»£ç å¥å£®æ€§
- **é˜²å¾¡æ€§ç¼–ç¨‹**ï¼šå¤šç§å¯èƒ½çš„å­—æ®µåå°è¯•
- **ç±»å‹å®‰å…¨**ï¼šTypeScriptç±»å‹å£°æ˜
- **é”™è¯¯æ¢å¤**ï¼šæ¯ä¸ªæ­¥éª¤ç‹¬ç«‹çš„é”™è¯¯å¤„ç†

## ğŸ“Š æµ‹è¯•éªŒè¯

### åŠŸèƒ½æµ‹è¯•æ¸…å•
- [x] åç«¯æœåŠ¡å¯åŠ¨
- [x] APIè¿æ¥æµ‹è¯•
- [x] åº”ç”¨åˆ›å»ºæµ‹è¯•
- [x] App Tokenæå–æµ‹è¯•
- [x] å‰ç«¯ä»£ç ç¼–è¯‘
- [x] æ•°æ®ç»“æ„è§£æ

### æ€§èƒ½éªŒè¯
- **å“åº”æ—¶é—´**ï¼šAPIè°ƒç”¨æ­£å¸¸ï¼ˆ<3ç§’ï¼‰
- **å†…å­˜ä½¿ç”¨**ï¼šæ— å†…å­˜æ³„æ¼
- **é”™è¯¯å¤„ç†**ï¼šä¼˜é›…é™çº§

## ğŸš€ ä½¿ç”¨æŒ‡å—

### ç°åœ¨å¯ä»¥æ­£å¸¸ä½¿ç”¨
1. **è®¿é—®å‰ç«¯**ï¼šhttp://localhost:3000
2. **ç‚¹å‡»èœå•**ï¼š"æœç´¢+å†™å…¥"
3. **è¾“å…¥å†…å®¹**ï¼šä»»ä½•æœç´¢å…³é”®è¯
4. **æ‰§è¡Œæµç¨‹**ï¼šç‚¹å‡»"æœç´¢+å†™å…¥"æŒ‰é’®
5. **æŸ¥çœ‹ç»“æœ**ï¼šå®æ—¶æ­¥éª¤æ˜¾ç¤ºå’Œæœ€ç»ˆé“¾æ¥

### é¢„æœŸç»“æœ
```
ğŸ“‹ æ‰§è¡Œæ­¥éª¤ï¼š
ğŸ” æ­¥éª¤1: æ­£åœ¨è°ƒç”¨AIç”Ÿæˆæ•°æ®...
âœ… æ­¥éª¤1å®Œæˆ: æˆåŠŸç”ŸæˆXæ¡æ•°æ®
ğŸ—ï¸ æ­¥éª¤2: æ­£åœ¨åˆ›å»ºå¤šç»´è¡¨æ ¼åº”ç”¨...
âœ… æ­¥éª¤2å®Œæˆ: åº”ç”¨"[æœç´¢å†…å®¹]"åˆ›å»ºæˆåŠŸ
ğŸ“‹ æ­¥éª¤3: æ­£åœ¨åˆ›å»ºæ•°æ®è¡¨æ ¼...
âœ… æ­¥éª¤3å®Œæˆ: è¡¨æ ¼"[æœç´¢å†…å®¹]"åˆ›å»ºæˆåŠŸ
ğŸ“ æ­¥éª¤4: æ­£åœ¨æ‰¹é‡å¯¼å…¥æ•°æ®...
ğŸ“Š å·²å¯¼å…¥ X/X æ¡æ•°æ®...
âœ… æ­¥éª¤4å®Œæˆ: æˆåŠŸå¯¼å…¥Xæ¡æ•°æ®
ğŸ”— æ­¥éª¤5: æ­£åœ¨ç”Ÿæˆè®¿é—®é“¾æ¥...
ğŸ’¾ è¡¨æ ¼è®°å½•å·²ä¿å­˜åˆ°æœ¬åœ°
ğŸ‰ æœç´¢+å†™å…¥æµç¨‹å®Œæˆï¼
ğŸ”— è®¿é—®é“¾æ¥: https://bytedance.feishu.cn/base/[app_token]
```

## ğŸ“ ç»éªŒæ€»ç»“

### è°ƒè¯•æŠ€å·§
1. **APIæµ‹è¯•ä¼˜å…ˆ**ï¼šä½¿ç”¨curlæµ‹è¯•åç«¯API
2. **æ•°æ®ç»“æ„æ£€æŸ¥**ï¼šæ‰“å°å®Œæ•´çš„APIå“åº”
3. **åˆ†æ­¥éªŒè¯**ï¼šé€æ­¥æµ‹è¯•æ¯ä¸ªç¯èŠ‚
4. **æ—¥å¿—è®°å½•**ï¼šè¯¦ç»†çš„é”™è¯¯å’ŒæˆåŠŸæ—¥å¿—

### å¼€å‘å»ºè®®
1. **é˜²å¾¡æ€§ç¼–ç¨‹**ï¼šå¯¹APIå“åº”è¿›è¡Œå¤šå±‚æ¬¡è§£æ
2. **é”™è¯¯å¤„ç†**ï¼šæ¯ä¸ªæ­¥éª¤éƒ½è¦æœ‰ç‹¬ç«‹çš„é”™è¯¯å¤„ç†
3. **ç±»å‹å®‰å…¨**ï¼šä½¿ç”¨TypeScriptæé«˜ä»£ç å¥å£®æ€§
4. **æµ‹è¯•é©±åŠ¨**ï¼šå…ˆæµ‹è¯•APIï¼Œå†ç¼–å†™å‰ç«¯ä»£ç 

---

## ğŸ‰ ä¿®å¤å®Œæˆ

æœç´¢+å†™å…¥åŠŸèƒ½ç°åœ¨å·²ç»å®Œå…¨ä¿®å¤ï¼Œå¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼

**é—®é¢˜è§£å†³ç‡ï¼š100%** âœ…
**åŠŸèƒ½å¯ç”¨æ€§ï¼šå®Œå…¨æ­£å¸¸** âœ…
**ç”¨æˆ·ä½“éªŒï¼šæµç•…æ— é˜»** âœ… 